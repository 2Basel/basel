<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EUI Physics Project | Basel.Expert</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;700&family=Roboto+Mono:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --bg-color: #050505;
            --panel-bg: rgba(20, 20, 25, 0.9);
            --text-primary: #ffffff;
            --text-secondary: #94a3b8;
            --accent-color: #60a5fa;
            --accent-glow: rgba(96, 165, 250, 0.3);
            --border-color: rgba(255, 255, 255, 0.15);
            --glass: blur(12px);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: var(--bg-color); }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 4px; }

        body {
            background-color: var(--bg-color);
            color: var(--text-primary);
            font-family: 'Outfit', sans-serif;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* HEADER */
        header {
            height: 70px;
            padding: 0 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border-color);
            background: rgba(5, 5, 5, 0.95);
            z-index: 20;
        }

        .brand { font-weight: 700; font-size: 1.3rem; display: flex; align-items: center; gap: 10px; letter-spacing: -0.5px; color: white; }
        .brand i { color: var(--accent-color); font-size: 1.1rem; }
        .brand-subtitle { font-weight: 300; opacity: 0.8; font-size: 0.9rem; margin-left: 5px; border-left: 1px solid #555; padding-left: 10px; color: var(--text-secondary); letter-spacing: 1px; }

        /* MODIFIED: Centered Alignment for IDs */
        .project-badge { 
            display: flex; 
            flex-direction: column; 
            align-items: center; /* This centers the text over the box */
            justify-content: center; 
        }
        
        .uni-tag {
            font-size: 0.65rem; 
            color: var(--accent-color); 
            font-weight: 700; 
            letter-spacing: 2px; /* Increased spacing for cleaner look */
            margin-bottom: 5px; 
            text-transform: uppercase; 
            text-shadow: 0 0 10px rgba(96, 165, 250, 0.4);
        }
        
        .student-ids {
            display: flex; align-items: center; gap: 12px; background: rgba(255, 255, 255, 0.06); border: 1px solid var(--border-color); padding: 6px 16px; border-radius: 50px; font-family: 'Roboto Mono', monospace; font-size: 0.85rem; color: var(--text-secondary); transition: 0.3s;
        }
        .student-ids:hover { background: rgba(255, 255, 255, 0.1); border-color: rgba(255, 255, 255, 0.3); color: white; }
        .divider { height: 14px; width: 1px; background: rgba(255,255,255,0.2); }

        /* MAIN LAYOUT */
        main { flex: 1; display: flex; height: calc(100vh - 70px); }

        /* SIDEBAR */
        .sidebar {
            width: 320px; background: var(--panel-bg); backdrop-filter: var(--glass); border-right: 1px solid var(--border-color); padding: 25px; display: flex; flex-direction: column; gap: 25px; overflow-y: auto; flex-shrink: 0;
        }

        h3 { font-size: 0.75rem; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 1.2px; margin-bottom: 12px; border-bottom: 1px solid var(--border-color); padding-bottom: 5px; }

        .control-group { margin-bottom: 5px; }
        .label-row { display: flex; justify-content: space-between; margin-bottom: 10px; font-size: 0.9rem; color: #eee; }
        .val-display { font-family: 'Roboto Mono', monospace; color: var(--accent-color); font-weight: bold; }

        input[type=range] { -webkit-appearance: none; width: 100%; height: 6px; background: rgba(255,255,255,0.1); border-radius: 5px; outline: none; }
        input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; width: 18px; height: 18px; background: var(--accent-color); border-radius: 50%; cursor: pointer; transition: transform 0.2s; margin-top: -6px; }
        input[type=range]::-webkit-slider-thumb:hover { transform: scale(1.1); box-shadow: 0 0 10px var(--accent-glow); }

        .color-row { display: flex; gap: 10px; }
        .color-dot { width: 26px; height: 26px; border-radius: 50%; cursor: pointer; border: 2px solid transparent; transition: all 0.3s; }
        .color-dot.active { border-color: white; transform: scale(1.2); box-shadow: 0 0 10px rgba(255,255,255,0.3); }

        .btn { width: 100%; padding: 14px; border: none; border-radius: 8px; font-family: 'Outfit', sans-serif; font-weight: 600; cursor: pointer; transition: 0.2s; display: flex; align-items: center; justify-content: center; gap: 8px; font-size: 0.95rem; }
        .btn-primary { background: var(--accent-color); color: #000; box-shadow: 0 4px 20px var(--accent-glow); margin-bottom: 10px; }
        .btn-primary:active { transform: scale(0.98); }
        .btn-outline { background: transparent; border: 1px solid var(--border-color); color: var(--text-secondary); font-size: 0.85rem; }
        .btn-outline:hover { border-color: var(--text-primary); color: var(--text-primary); background: rgba(255,255,255,0.05); }

        .presets-grid { display: flex; flex-direction: column; gap: 10px; }

        /* VIZ AREA */
        .viz-area { flex: 1; position: relative; background-color: #080808; overflow: hidden; background: radial-gradient(circle at bottom left, #111, #050505); }

        .hud-overlay {
            position: absolute; top: 20px; left: 20px; background: rgba(10, 10, 12, 0.95); border: 1px solid var(--border-color); padding: 15px; border-radius: 8px; font-family: 'Roboto Mono', monospace; font-size: 0.8rem; color: var(--text-secondary); pointer-events: none; backdrop-filter: blur(5px); min-width: 180px; box-shadow: 0 10px 40px rgba(0,0,0,0.6);
        }
        .hud-row { display: flex; justify-content: space-between; margin-bottom: 6px; }
        .hud-val { color: var(--text-primary); font-weight: 600; }
        
        .scale-info { position: absolute; bottom: 15px; right: 25px; color: rgba(255,255,255,0.2); font-size: 0.75rem; font-family: 'Roboto Mono', monospace; letter-spacing: 1px; }

        /* DATA TABLE */
        .data-panel { height: 220px; background: var(--panel-bg); border-top: 1px solid var(--border-color); display: flex; flex-direction: column; backdrop-filter: var(--glass); }
        .table-wrap { overflow: auto; flex: 1; }
        table { width: 100%; border-collapse: collapse; font-size: 0.85rem; text-align: left; }
        thead { position: sticky; top: 0; z-index: 5; background: #1a1a20; }
        th { padding: 12px 20px; color: var(--text-secondary); font-weight: 500; font-size: 0.7rem; text-transform: uppercase; border-bottom: 2px solid var(--border-color); white-space: nowrap; letter-spacing: 0.5px; }
        td { padding: 10px 20px; border-bottom: 1px solid rgba(255,255,255,0.05); color: var(--text-primary); font-family: 'Roboto Mono', monospace; white-space: nowrap; }
        tr:nth-child(even) { background: rgba(255,255,255,0.02); }
        
        canvas { display: block; width: 100%; height: 100%; }
        
        @media (max-width: 900px) {
            main { flex-direction: column; height: auto; }
            .sidebar { width: 100%; height: auto; border-right: none; }
            .viz-area { height: 50vh; }
            .project-badge { display: none; }
        }
    </style>
</head>
<body>

    <header>
        <div class="brand">
            <i class="fa-solid fa-bolt"></i> BASEL.EXPERT 
            <span class="brand-subtitle">| EUI PHYSICS PROJECT</span>
        </div>
        
        <div class="project-badge">
            <div class="uni-tag">Students' IDs</div>
            <div class="student-ids">
                <span><i class="fa-regular fa-user" style="font-size:0.8rem"></i> 25-104097</span>
                <span class="divider"></span>
                <span>25-100589</span>
            </div>
        </div>
    </header>

    <main>
        <aside class="sidebar">
            <div>
                <h3>Initial Conditions</h3>
                <div class="control-group">
                    <div class="label-row"><span>Velocity (v₀)</span> <span id="v-disp" class="val-display">80 m/s</span></div>
                    <input type="range" id="v-slider" min="10" max="180" value="80">
                </div>
                <div class="control-group" style="margin-top:20px;">
                    <div class="label-row"><span>Angle (θ)</span> <span id="a-disp" class="val-display">45°</span></div>
                    <input type="range" id="a-slider" min="1" max="89" value="45">
                </div>
            </div>

            <div style="margin-top: 10px;">
                <h3>Time Control</h3>
                <div class="control-group">
                    <div class="label-row"><span>Sim Speed</span> <span id="s-disp" class="val-display">1.0x</span></div>
                    <input type="range" id="s-slider" min="0.1" max="3.0" step="0.1" value="1.0">
                </div>
            </div>

            <div>
                <h3>Trajectory Color</h3>
                <div class="color-row">
                    <div class="color-dot active" style="background:#60a5fa" data-c="#60a5fa"></div>
                    <div class="color-dot" style="background:#f43f5e" data-c="#f43f5e"></div>
                    <div class="color-dot" style="background:#34d399" data-c="#34d399"></div>
                    <div class="color-dot" style="background:#fbbf24" data-c="#fbbf24"></div>
                    <div class="color-dot" style="background:#a78bfa" data-c="#a78bfa"></div>
                </div>
            </div>

            <button id="btn-launch" class="btn btn-primary"><i class="fa-solid fa-play"></i> LAUNCH PROJECTILE</button>
            <button id="btn-clear" class="btn btn-outline"><i class="fa-solid fa-trash-can"></i> Clear All</button>

            <div style="margin-top: 20px;">
                <h3>Comparison Presets</h3>
                <div class="presets-grid">
                    <button class="btn btn-outline" onclick="loadPreset('classic')">
                        <i class="fa-solid fa-layer-group"></i> 30° vs 45° vs 60°
                    </button>
                    <button class="btn btn-outline" onclick="loadPreset('complementary')">
                        <i class="fa-solid fa-check-double"></i> Complementary (15° & 75°)
                    </button>
                    <button class="btn btn-outline" onclick="loadPreset('velocity')">
                        <i class="fa-solid fa-forward"></i> Velocity Steps (+50 m/s)
                    </button>
                </div>
            </div>
        </aside>

        <div style="flex:1; display:flex; flex-direction:column; min-width: 0;">
            <div class="viz-area">
                <canvas id="simCanvas"></canvas>
                <div class="hud-overlay">
                    <div class="hud-row"><span>Time (t):</span> <span class="hud-val" id="hud-t">0.00 s</span></div>
                    <div class="hud-row"><span>Range (x):</span> <span class="hud-val" id="hud-x">0.00 m</span></div>
                    <div class="hud-row"><span>Height (y):</span> <span class="hud-val" id="hud-y">0.00 m</span></div>
                    <div class="hud-row" style="margin-top:8px; padding-top:8px; border-top:1px solid rgba(255,255,255,0.1)">
                        <span id="hud-status" style="color:#34d399; font-size:0.75rem; letter-spacing:1px;">READY</span>
                    </div>
                </div>
                <div class="scale-info" id="scale-info">Scale: Auto-Calibrated</div>
            </div>
            <div class="data-panel">
                <div class="table-wrap">
                    <table>
                        <thead>
                            <tr>
                                <th>Trace</th>
                                <th>V0 (m/s)</th>
                                <th>Angle (°)</th>
                                <th>Flight Time (s)</th>
                                <th>Max Height (m)</th>
                                <th>Total Range (m)</th>
                            </tr>
                        </thead>
                        <tbody id="data-body"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </main>

    <script>
        const G = 9.81;
        let timeMultiplier = 1.0;
        const canvas = document.getElementById('simCanvas');
        const ctx = canvas.getContext('2d');
        let width, height;
        let dynamicScale = 4;
        let projectiles = [];
        let animationId;
        let currentColor = '#60a5fa';

        const els = {
            vSlider: document.getElementById('v-slider'),
            vDisp: document.getElementById('v-disp'),
            aSlider: document.getElementById('a-slider'),
            aDisp: document.getElementById('a-disp'),
            sSlider: document.getElementById('s-slider'),
            sDisp: document.getElementById('s-disp'),
            hudT: document.getElementById('hud-t'),
            hudX: document.getElementById('hud-x'),
            hudY: document.getElementById('hud-y'),
            hudStatus: document.getElementById('hud-status'),
            tableBody: document.getElementById('data-body'),
            scaleInfo: document.getElementById('scale-info')
        };

        function resize() {
            width = canvas.offsetWidth;
            height = canvas.offsetHeight;
            canvas.width = width;
            canvas.height = height;
        }
        window.addEventListener('resize', resize);
        resize();

        class Projectile {
            constructor(id, v0, angle, color) {
                this.id = id;
                this.v0 = v0;
                this.angle = angle;
                this.color = color;
                
                // EXACT Physics Calculations
                this.rad = angle * Math.PI / 180;
                this.vx = v0 * Math.cos(this.rad);
                this.vy0 = v0 * Math.sin(this.rad);
                
                this.totalTime = (2 * this.vy0) / G;
                this.maxHeight = (Math.pow(this.vy0, 2)) / (2 * G);
                this.maxRange = this.vx * this.totalTime;

                this.t = 0;
                this.x = 0;
                this.y = 0;
                this.landed = false;
                this.path = [{x:0, y:0}];
            }

            update(dt) {
                if (this.landed) return;

                this.t += dt;

                if (this.t >= this.totalTime) {
                    this.t = this.totalTime;
                    this.x = this.maxRange;
                    this.y = 0;
                    this.landed = true;
                } else {
                    this.x = this.vx * this.t;
                    this.y = (this.vy0 * this.t) - (0.5 * G * this.t * this.t);
                }
                
                this.path.push({x: this.x, y: this.y});
            }

            draw() {
                const s = dynamicScale;
                const groundY = height;

                if (this.path.length > 1) {
                    ctx.beginPath();
                    ctx.moveTo(0, groundY);
                    for (let point of this.path) {
                        ctx.lineTo(point.x * s, groundY - (point.y * s));
                    }
                    ctx.strokeStyle = this.color;
                    ctx.lineWidth = 2.5;
                    ctx.lineCap = 'round';
                    ctx.stroke();
                }

                if (this.landed) {
                    const finalX = this.maxRange * s;
                    const stemH = 40;
                    
                    ctx.beginPath();
                    ctx.setLineDash([3, 3]);
                    ctx.moveTo(finalX, groundY);
                    ctx.lineTo(finalX, groundY - stemH);
                    ctx.strokeStyle = this.color;
                    ctx.lineWidth = 1;
                    ctx.stroke();
                    ctx.setLineDash([]);

                    ctx.beginPath();
                    ctx.arc(finalX, groundY, 3, 0, Math.PI*2);
                    ctx.fillStyle = this.color;
                    ctx.fill();

                    drawBadge(ctx, finalX, groundY - stemH, this.maxRange.toFixed(2) + 'm', this.color);

                } else {
                    const cx = this.x * s;
                    const cy = groundY - (this.y * s);
                    
                    ctx.beginPath();
                    ctx.arc(cx, cy, 6, 0, Math.PI*2);
                    ctx.fillStyle = '#fff';
                    ctx.fill();
                    
                    ctx.shadowBlur = 15;
                    ctx.shadowColor = this.color;
                    ctx.beginPath();
                    ctx.arc(cx, cy, 6, 0, Math.PI*2);
                    ctx.fill();
                    ctx.shadowBlur = 0;

                    updateHUD(this);
                }
            }
        }

        function drawBadge(ctx, x, y, text, color) {
            const pad = 6;
            ctx.font = "bold 11px Roboto Mono";
            const metrics = ctx.measureText(text);
            const w = metrics.width + (pad * 2);
            const h = 22;
            const bx = x - w/2;
            const by = y - h;

            ctx.fillStyle = color;
            ctx.beginPath();
            ctx.roundRect(bx, by, w, h, 4);
            ctx.fill();

            ctx.fillStyle = "#000";
            ctx.textAlign = "center";
            ctx.textBaseline = "middle";
            ctx.fillText(text, x, by + h/2 + 1);
        }

        function updateHUD(p) {
            els.hudT.innerText = p.t.toFixed(2) + ' s';
            els.hudX.innerText = p.x.toFixed(2) + ' m';
            els.hudY.innerText = p.y.toFixed(2) + ' m';
            els.hudStatus.innerText = "SIMULATING...";
            els.hudStatus.style.color = p.color;
        }

        function calculateScale() {
            if (projectiles.length === 0) {
                dynamicScale = 4;
                return;
            }
            let maxRange = 0; let maxH = 0;
            
            projectiles.forEach(p => {
                if (p.maxRange > maxRange) maxRange = p.maxRange;
                if (p.maxHeight > maxH) maxH = p.maxHeight;
            });

            maxRange = Math.max(maxRange * 1.1, 50);
            maxH = Math.max(maxH * 1.2, 20);

            const sx = width / maxRange; 
            const sy = height / maxH;
            
            dynamicScale = Math.min(sx, sy);
            els.scaleInfo.innerText = `Scale: 1m = ${dynamicScale.toFixed(2)}px`;
        }

        function launch(v0, angle, color) {
            const p = new Projectile(projectiles.length + 1, v0, angle, color);
            projectiles.push(p);
            
            const row = `<tr>
                <td><span style="display:inline-block;width:12px;height:12px;background:${p.color};border-radius:50%;margin-right:8px;vertical-align:middle"></span> #${p.id}</td>
                <td>${p.v0}</td>
                <td>${p.angle}°</td>
                <td>${p.totalTime.toFixed(3)}</td>
                <td>${p.maxHeight.toFixed(3)}</td>
                <td style="color:${p.color};font-weight:700">${p.maxRange.toFixed(3)}</td>
            </tr>`;
            
            els.tableBody.insertAdjacentHTML('afterbegin', row);
            
            if (!animationId) animate();
        }

        function clearSim() {
            projectiles = [];
            els.tableBody.innerHTML = '';
            ctx.clearRect(0, 0, width, height);
            drawGrid();
            els.hudStatus.innerText = "READY";
            els.hudStatus.style.color = "#fff";
        }

        function drawGrid() {
            const s = dynamicScale;
            let gridStep = 10;
            if (s < 2) gridStep = 50;
            if (s < 0.5) gridStep = 100;
            const pixelStep = gridStep * s; 
            
            ctx.beginPath();
            ctx.strokeStyle = 'rgba(255,255,255,0.04)';
            ctx.lineWidth = 1;
            
            for(let x=0; x<width; x+=pixelStep) { 
                ctx.moveTo(x, 0); ctx.lineTo(x, height); 
            }
            for(let y=height; y>0; y-=pixelStep) { 
                ctx.moveTo(0, y); ctx.lineTo(width, y); 
            }
            ctx.stroke();

            ctx.beginPath();
            ctx.strokeStyle = '#fff';
            ctx.lineWidth = 2;
            ctx.moveTo(0, height); ctx.lineTo(width, height);
            ctx.stroke();
        }

        function animate() {
            resize();
            calculateScale();
            ctx.clearRect(0, 0, width, height);
            drawGrid();

            let active = false;
            const dt = 0.016 * timeMultiplier; 

            projectiles.forEach(p => {
                p.update(dt);
                p.draw();
                if (!p.landed) active = true;
            });

            if (!active && projectiles.length > 0) {
                els.hudStatus.innerText = "COMPLETE";
                els.hudStatus.style.color = "#94a3b8";
            }
            
            animationId = requestAnimationFrame(animate);
        }

        els.vSlider.oninput = (e) => els.vDisp.innerText = e.target.value + ' m/s';
        els.aSlider.oninput = (e) => els.aDisp.innerText = e.target.value + '°';
        els.sSlider.oninput = (e) => {
            timeMultiplier = parseFloat(e.target.value);
            els.sDisp.innerText = timeMultiplier.toFixed(1) + 'x';
        };

        document.querySelectorAll('.color-dot').forEach(d => {
            d.onclick = function() {
                document.querySelector('.color-dot.active').classList.remove('active');
                this.classList.add('active');
                currentColor = this.dataset.c;
            }
        });

        document.getElementById('btn-launch').onclick = () => {
            launch(parseInt(els.vSlider.value), parseInt(els.aSlider.value), currentColor);
        };
        document.getElementById('btn-clear').onclick = clearSim;

        const PRESETS = {
            'classic': [{v:100, a:30, c:'#34d399'}, {v:100, a:45, c:'#60a5fa'}, {v:100, a:60, c:'#f43f5e'}],
            'complementary': [{v:120, a:15, c:'#fbbf24'}, {v:120, a:75, c:'#a78bfa'}],
            'velocity': [{v:50, a:45, c:'#34d399'}, {v:100, a:45, c:'#34d399'}, {v:150, a:45, c:'#34d399'}]
        };

        window.loadPreset = (name) => {
            clearSim();
            const set = PRESETS[name];
            set.forEach((shot, i) => {
                setTimeout(() => launch(shot.v, shot.a, shot.c), i * 350);
            });
        };

        animate();
    </script>
</body>
</html>
